---
title: "Measure of Joel"
subtitle: "in celebration of his birth"
date: "2021/09/24"
output:
  xaringan::moon_reader:
    lib_dir: libs
    self_contained: true
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

exclude: true

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, dpi = 300, fig.align = "center", fig.width = 10, fig.height = 6)
library(tidyverse)
source(here::here("data_analysis", "preprocessing.r"))

here::here("r_function") %>% 
  list.files() %>% 
  map(~source(here::here("r_function", .)))
```

---

# Intro  

In celebration of the birth of **Joel Le Forestier**, we created [a survey of Joel-centric questions](https://utorontopsych.az1.qualtrics.com/jfe/form/SV_0TcVdupdXsRkJJc)<sup>1</sup>. 

Raw data file<sup>2</sup> and r-syntax files are available at [Github](https://github.com/psy218/measure_of_joel). 


.footnote[
[1] MAKE SURE TO CLOSE COLLECTION BEFORE UPLOADING!  
[2] anonymous
]
---
class: inverse, middle, center

# Results

---

# Words to Describe Joel  
```{r}
library(wordcloud)
joel_words %>% 
  count(word, sort = T) %>% 
  with(wordcloud::wordcloud(word,
                            freq = n,
                            min.freq = 1,
                            max.words = 100,
                            random.order = F,
                            colors = viridis::viridis(n = 30, option = "D")))
```

---
# How amazing is Joel?   

Please indicate Joel’s level of amazingness and wonderfulness, using the following scale.  
1: Joel is amazing and wonderful! 
2: Joel is SO amazing and wonderful!  
3: Joel is SO VERY amazing and wonderful!  
4: Joel is literally the MOST amazing and wonderful!  
5: There is absolutely no doubt in my mind: Joel is THE most amazing and wonderful person EVER.  
6: Words cannot fully describe JUST HOW amazing and wonderful Joel is. This cannot be measured with a 6-point Likert scale, you fools. 

---
# How amazing is Joel?   

Please indicate Joel’s level of **amazingness** and **wonderfulness**, using the following scale.  

```{r}
dataset %>% 
  count(joel_amazingness) %>% 
  mutate(prop = round( n / sum(n)*100)) %>% 
  inner_join(joel_amazingness, by = c(joel_amazingness = "option_level")) %>% 
  # mutate_at("joel_amazingness", as.factor) %>% 
  mutate(joel_amazingness = factor(joel_amazingness,
                                   levels = joel_amazingness,
                                   labels = stringr::str_wrap(option_text, 25))) %>%
  pie_chart(., "joel_amazingness")

```

---
# Which of the following Joels would you most love to see?  

```{r}
dataset %>% 
  count(joel_version) %>% 
  inner_join(joel_version, by = c(joel_version = "option_level")) %>% 
  mutate(prop = round( n / sum(n)*100),
         joel_version = factor(joel_version,
                               levels = 1:4,
                               labels = stringr::str_wrap(option_text, 20))) %>%
  # mutate_at("joel_version", as.factor) %>% 
  bar_graph("joel_version")
  # pie_chart("joel_version")
```

---
# If Joel was a character in a book, which genre(s) would he appear in?     
```{r}
joel_movie_data = dataset %>% 
  select(pid, starts_with("joel_movie-")) %>% 
  pivot_longer(starts_with("joel_movie-"),
               names_to = "genre",
               values_to = "genre_count",
               names_prefix = "joel_movie-",
               values_drop_na = T) %>% 
  count(genre) %>% 
  mutate(genre = str_replace(genre, "Darkcomedy", "Dark Comedy"),
         prop = round( n / sum(n)*100))

joel_movie_pos = joel_movie_data %>% 
  mutate(csum = rev(cumsum(rev(n))), 
         pos = n/2 + lead(csum, 1),
         pos = if_else(is.na(pos), n/2, pos))
  # arrange(desc(genre)) %>% 
  # mutate(ypos = cumsum(prop) - 0.5*prop) %>% 

joel_movie_data %>%  
  ggplot(aes(x = "",
               y = n,
               fill = fct_inorder(genre))) +
geom_col(width = 1, color = 1) +
        # geom_bar(stat = "identity",
    #          width = 1) + 
    coord_polar(theta = "y") + 
    geom_text(aes(label = paste0(n, "\n(", prop,"%)")),
                  position = position_stack(vjust = .5)) +
    xlab(NULL) +
    scale_y_continuous(breaks = joel_movie_pos$pos,
                       labels = joel_movie_data$genre) + 
    viridis::scale_fill_viridis(guide = "none",
                                discrete = T,
                                begin = .2) +
  theme(axis.ticks = element_blank(),
        axis.title = element_blank(),
        axis.text = element_text(size = 9), 
        legend.position = "none", # Removes the legend
        panel.background = element_rect(fill = "white"))
```


---
# If Joel was a character in a book, which genre(s) would he appear in?     
```{r}
joel_movie_data %>% 
  mutate(option_text = genre,
         genre = fct_reorder(genre, n)) %>% 
  bar_graph("genre")
```

---
# Which of the following seasons best describes Joel?     
```{r}
dataset %>% 
  count(joel_season) %>% 
  mutate(prop = round( n / sum(n)*100)) %>% 
  inner_join(joel_season, by = c(joel_season = "option_level")) %>% 
  mutate(joel_season = factor(joel_season,
                              levels = joel_season, 
                              labels = option_text),
         option_text = str_to_title(option_text)) %>% 
  pie_chart("joel_season")
```
---
# Which of the following seasons best describes Joel?   
```{r}
dataset %>% 
  count(joel_season) %>% 
  mutate(prop = round( n / sum(n)*100)) %>% 
  inner_join(joel_season, by = c(joel_season = "option_level")) %>% 
  mutate(joel_season = factor(joel_season,
                              levels = joel_season, 
                              labels = option_text),
         option_text = str_to_title(option_text)) %>%
  bar_graph("joel_season")
```


---
# Which Joel-related conspiracy is most likely true?    

1 = Joel is actually immortal and has been walking the earth for about 150 years now - hence his wise nature
2 = Joel is actually a plant in the lab, put here to make us smarter and more productive by holding stimulating conversations and setting a good example
3 = Joel is a twin, and they tag team life, switching out each day
4 = Lily, Joel's adorable dog, is actually named after Lil Wayne
```{r eval = FALSE, include = FALSE}
dataset %>% 
  count(joel_conspiracy) %>% 
  mutate(prop = round( n / sum(n)*100)) %>% 
  inner_join(joel_conspiracy, by = c(joel_conspiracy = "option_level")) %>% 
  mutate(joel_conspiracy = factor(joel_conspiracy,
                              levels = joel_conspiracy, 
                              labels = stringr::str_wrap(option_text, 20)),
         option_text = str_to_title(option_text)) %>% 
  pie_chart("joel_conspiracy")
```

---
# Which Joel-related conspiracy is most likely true?  
```{r}
dataset %>% 
  count(joel_conspiracy) %>% 
  mutate(prop = round( n / sum(n)*100)) %>% 
  inner_join(joel_conspiracy, by = c(joel_conspiracy = "option_level")) %>% 
  mutate(joel_conspiracy = factor(joel_conspiracy,
                              levels = joel_conspiracy, 
                              labels = stringr::str_wrap(option_text, 20)),
         option_text = str_to_title(option_text)) %>% 
  bar_graph("joel_conspiracy")
```

---
# Who would win in a battle of wits: Joel or a goose?   
```{r}
dataset %>% 
  count(joel_goose) %>% 
  mutate(prop = round( n / sum(n)*100)) %>% 
  inner_join(joel_goose, by = c(joel_goose = "option_level")) %>% 
  mutate(joel_goose = factor(joel_goose,
                              levels = joel_goose, 
                              labels = stringr::str_wrap(option_text, 20)),
         option_text = str_to_title(option_text)) %>% 
  bar_graph("joel_goose")
```




---
# How many times do you want to wish Joel a Happy Birthday?   

```{r}
dataset %>% 
  mutate(bday_wish_max = ifelse(joel_bdaywishes == max(joel_bdaywishes, na.rm = T), "max", "other")) %>% 
  ggplot(aes(x = reorder(factor(pid), -joel_bdaywishes),
             y = joel_bdaywishes,
             fill = bday_wish_max)) +
  geom_bar(stat = "identity",
           position = position_dodge(.8)) +
  geom_hline(aes(yintercept = mean(dataset$joel_bdaywishes, na.rm = T)),
             linetype = "dashed") +
  geom_text(aes(label = joel_bdaywishes),
              position = position_dodge(.8),
              hjust = -0.25) +
  scale_x_discrete(breaks = NULL,
                   "") +
  scale_y_continuous("Number of B-Day Wishes",
                     # breaks = unique(dataset$joel_bdaywishes),
                     trans = "log10") +
  scale_fill_manual(guide = "none",
                    values = c("#D55E00", "#999999")) +
  theme_classic() +
  coord_flip() 
```
*Note*. The average number of birthday wishes is indicated by the dashed line.  


